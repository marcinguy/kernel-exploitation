# Modern Kernel Exploitation

Tested on modern kernel

Used 32 bit for simplicity.


Kernel 4.3.5

Compiled vulnerable module

[Vulnerable Module](/vuln-mod.c)


Wrote exploit to take advantage of the vulnerability
[Vulnerable Module Exploit](/exploit-vuln-mod.c)


Local Root Exploit (chage privs of the current process to root)

Was hard to find working example with commit_creds.

Used two threads, one with shell the other one calling commit_creds and called 
after overwriting EIP (root privs)



## Wanted to exploit BlueBorne - Bluetooth Stack Overflow (CVE-2017-1000251)

Challenges:

Read Bluetooth Documentation (very long)

Understand L2CAP Protocol and Messages exchanges.

Compile Kernel with Debug capabilities (via Virtual Serial Device in Virtual Box)

Debug Kernel :)

Trigger BlueBorne

Disable Kernel Protection NX and Stack Canaries

Prepare Shellcode (Trick out the Bluetooth Protocol to pack shellcode in)

Tested with 32 bit Kernel without Protections

Tricking out L2CAP messages

Finding Gadgets

Packing up shellcode

printk() shellcode

Stabilizing Kernel after shellcode execute (msleep)

Executing

