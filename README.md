Modern Kernel Exploitation

Tested on modern kernel


Kernel 4.3.5

Compiled vulnerable module


Wrote exploit to take advantage of the vulnerability

Local Root Exploit (chage privs of the current process to root)



Wanted to exploit BlueBorne

Challenges:

Read Bluetooth Documentation (very long)

Understand L2CAP Protocol and Messages exchanges.

Compile Kernel with Debug capabilities (via Virtual Serial Device in Virtual Box)

Debug Kernel :)

Trigger BlueBorne

Disable Kernel Protection NX and Stack Canaries

Prepare Shellcode (Trick out the Bluetooth Protocol to pack shellcode in)

Tested with 32 bit Kernel without Protections

Tricking out L2CAP messages

Finding Gadgets

Packing up shellcode

printk() shellcode

Stabilizing Kernel after shellcode execute (msleep)

Executing

